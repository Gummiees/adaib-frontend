<div class="w-full pt-6 pb-4 flex flex-col gap-2 items-center">
  <div class="w-full flex gap-4 items-center justify-center">
    <h2 class="text-4xl font-bold text-center">Resultados</h2>
    @if(!!userStore.user()) {
      <a mat-mini-fab aria-label="Añadir partido" matTooltip="Añadir partido" matTooltipPosition="right" tabindex="0" (click)="onAddMatchClick()" (keyup)="onAddMatchClick()" (keypress)="onAddMatchClick()">
        <mat-icon>add</mat-icon>
      </a>
    }
  </div>
  @if(competitionStore.competition()!.phases.length > 0) {
    <div class="flex flex-col lg:flex-row gap-2 w-full max-w-200 lg:max-w-none justify-center overflow-x-hidden">
      <app-phase-filter class="w-full max-w-200"></app-phase-filter>

      @if(availableGroups().length > 0) {
        <app-group-filter class="w-full max-w-200"></app-group-filter>
      }
      @if(availableRounds().length > 0) {
        <app-round-filter class="w-full max-w-200"></app-round-filter>
        <mat-form-field class="w-full max-w-200">
          <mat-label>Agrupar</mat-label>
          <mat-select [value]="groupByRound()" (selectionChange)="onGroupByRoundChange($event.value)">
            <mat-option [value]="false">No agrupar</mat-option>
            <mat-option [value]="true">Agrupar por jornadas</mat-option>
          </mat-select>
        </mat-form-field>
      }
    </div>
  }


  @if(groupByRound() && filteredMatchesByRound().length > 0) {
    @for (round of filteredMatchesByRound(); track round.id) {
      <h3 class="text-xl font-bold text-center py-1">{{ round.name }}</h3>
      @if(round.matches.length > 0) {
        @for (match of round.matches; track match.id) {
          <app-match class="w-full flex justify-center" [match]="match" (matchTeamClicked)="onMatchTeamClicked($event)"></app-match>
        }
      }
    }
  } @else if(filteredMatches().length > 0) {
    @for (match of filteredMatches(); track match.id) {
      <app-match class="w-full flex justify-center" [match]="match" (matchTeamClicked)="onMatchTeamClicked($event)"></app-match>
    }
  } @else {
    <app-not-found title="No hay resultados" subtitle="No hay resultados disponibles." [hideButton]="true"></app-not-found>
  }
</div>
